import{o as q,c as N,a as de,u as E,R as Ne,F as we,b as d,r as C,w as Q,d as J,v as Ae,e as Ue,f as ee,t as j,g as ke,h as be,i as Y,j as Le,k as Oe,l as Ve,s as $,p as He,m as ze,n as Ie,q as Pe,x as Fe,y as je,z as Re,A as We,B as Xe,C as Ke,D as Qe}from"./vendor.bfe29a18.js";const Je=function(){const k=document.createElement("link").relList;if(k&&k.supports&&k.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))x(n);new MutationObserver(n=>{for(const h of n)if(h.type==="childList")for(const m of h.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&x(m)}).observe(document,{childList:!0,subtree:!0});function c(n){const h={};return n.integrity&&(h.integrity=n.integrity),n.referrerpolicy&&(h.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?h.credentials="include":n.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function x(n){if(n.ep)return;n.ep=!0;const h=c(n);fetch(n.href,h)}};Je();const Ye=d("header",null,null,-1),Ge={setup(T){return(k,c)=>(q(),N(we,null,[Ye,de(E(Ne))],64))}},Ze="modulepreload",De={},et="/infomedia/",_e=function(k,c){return!c||c.length===0?k():Promise.all(c.map(x=>{if(x=`${et}${x}`,x in De)return;De[x]=!0;const n=x.endsWith(".css"),h=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${h}`))return;const m=document.createElement("link");if(m.rel=n?"stylesheet":Ze,n||(m.as="script",m.crossOrigin=""),m.href=x,document.head.appendChild(m),n)return new Promise((A,w)=>{m.addEventListener("load",A),m.addEventListener("error",w)})})).then(()=>k())},P={title:"Infomedia | How do algorithms make the news?",helpPage:"help-infomedia",esIndex:"infomedia",esTextField:"text",esEntitiesField:"entities",esTitleField:"heading",esSourceField:"sourcename",esDateField:"publishdate",basemap:"/infomedia/data/Infomedia basemap.csv",heatmapSpread:2,basemapNodeSizeRatio:1,basemapLabels:[{x:256,y:1058,anchor:"left",label:"European politics"},{x:602,y:907,anchor:"left",label:"International conflict"},{x:892,y:408,anchor:"left",label:"American politics"},{x:963,y:179,anchor:"left",label:"Music industry"},{x:693,y:-801,anchor:"left",label:"Arts & entertainment"},{x:12,y:-1251,anchor:"center",label:"Tech"},{x:-907,y:-588,anchor:"right",label:"Danish business"},{x:-851,y:537,anchor:"right",label:"Research & education"},{x:-473,y:1036,anchor:"right",label:"Danish politics"},{x:-321,y:1170,anchor:"center",label:"The Chinese dilemma"},{x:-217,y:38,anchor:"center",label:"Soccer"},{x:-217,y:38,anchor:"center",label:"Soccer"},{x:-15,y:211,anchor:"center",label:"Climate & development"}],basemapLabelsLines:[[[-121,846],[-321,1130]]],basemapPolygons:[[[155,599],[238,570],[335,614],[396,729],[429,884],[407,1003],[310,1090],[119,1122],[-15,1104],[-119,1032],[-130,967],[-58,931],[28,877],[72,819],[122,718],[137,635],[155,599]],[[-62,870],[31,815],[78,725],[94,604],[55,511],[-39,491],[-70,608],[-78,718],[-133,796],[-121,846],[-62,870]],[[-86,339],[-43,366],[-51,452],[-109,597],[-117,714],[-215,835],[-308,948],[-457,998],[-667,987],[-812,827],[-831,616],[-741,515],[-605,441],[-523,378],[-386,316],[-277,304],[-168,312],[-86,339]],[[-975,550],[-897,620],[-741,612],[-566,546],[-457,472],[-375,386],[-300,238],[-320,148],[-375,89],[-468,74],[-581,82],[-741,144],[-882,222],[-972,335],[-1011,472],[-975,550]],[[-148,109],[-121,78],[-125,-32],[-168,-71],[-242,-71],[-308,-55],[-339,-8],[-289,62],[-234,101],[-179,113],[-148,109]],[[-113,82],[-129,117],[-129,253],[-59,308],[-59,308],[47,331],[121,265],[101,183],[101,183],[51,58],[-8,50],[-8,50],[-74,58],[-113,82]],[[-1280,206],[-1093,327],[-882,327],[-667,234],[-499,144],[-390,70],[-316,-51],[-254,-164],[-195,-316],[-222,-527],[-304,-656],[-652,-913],[-652,-913],[-933,-933],[-1143,-812],[-1342,-515],[-1412,-285],[-1389,0],[-1280,206]],[[18,-403],[212,-391],[453,-502],[496,-625],[496,-625],[488,-779],[417,-1012],[50,-1225],[50,-1225],[-215,-1194],[-413,-1071],[-500,-933],[-464,-739],[-314,-565],[-160,-482],[18,-403]],[[694,-71],[690,-12],[777,150],[915,225],[915,225],[1069,229],[1164,51],[1164,51],[1133,-107],[1065,-166],[935,-174],[828,-162],[733,-119],[694,-71]],[[453,284],[552,229],[643,107],[643,107],[801,-162],[801,-162],[931,-285],[978,-439],[907,-625],[773,-743],[627,-814],[382,-715],[382,-715],[315,-593],[271,-383],[263,-158],[307,150],[307,150],[366,241],[453,284]],[[635,715],[729,743],[880,719],[880,719],[963,652],[1022,533],[1034,427],[994,304],[915,253],[781,237],[623,312],[556,415],[567,632],[567,632],[635,715]],[[315,838],[413,877],[560,881],[686,861],[706,786],[646,581],[575,502],[575,502],[374,442],[374,442],[279,601],[279,601],[295,707],[291,759],[315,838]]]},tt={class:"pure-form",style:{display:"flex",padding:"12px"}},at=["onKeyup"],st=["href"],nt={props:{query:String},emits:["query"],setup(T,{emit:k}){const c=T,x=C("");Q(()=>c.query,function(){x.value=c.query});function n(){k("query",x.value)}return(h,m)=>(q(),N("div",tt,[J(d("input",{type:"text","onUpdate:modelValue":m[0]||(m[0]=A=>x.value=A),onKeyup:Ue(n,["enter"]),class:"pure-input-rounded",style:{"margin-right":"12px","flex-grow":"1"}},null,40,at),[[Ae,x.value]]),d("button",{class:"pure-button pure-button-primary",onClick:n,style:{width:"200px","margin-right":"12px"}}," Filter "),d("a",{class:"pure-button",href:E(P).helpPage,target:"_blank"},"Help?",8,st)]))}};const lt={key:0,style:{"text-align":"center"}},ot={key:1,style:{"flex-grow":"1",display:"flex","flex-direction":"column","overflow-y":"hidden"}},it={style:{padding:"6px"}},rt={class:"pure-form"},ct={for:"show-text",style:{padding:"6px"}},ht=Y(" Show text "),ut={for:"show-entities",style:{padding:"6px"}},dt=Y(" Show named entities "),ft={style:{padding:"6px"}},gt={style:{"flex-grow":"1","overflow-y":"auto"}},pt=["onMouseenter","onClick"],vt={key:0,class:"card-content",style:{"white-space":"pre-wrap"}},yt={key:1,class:"pill-box"},mt=["onMouseenter","onMouseleave"],xt={key:0,style:{padding:"6px","text-align":"center"}},bt={props:{docsTotal:Number,docs:Array,dataLoaded:Boolean,loadBatch:Function},emits:["focusedEntities"],setup(T,{emit:k}){const c=C(!1),x=C(!1);C(!1);const n=C((w,M)=>M.split(".").reduce((b,D)=>b==null?void 0:b[D],w));let h=C(function(w){w&&w._source?k("focusedEntities",{highlight:!0,entities:n.value(w._source,P.esEntitiesField)||[]}):k("focusedEntities",{highlight:!1,entities:[]})}),m=C(function(w){k("focusedEntities",{highlight:!0,entities:[w]})}),A=C(function(w){Be.resolve({name:"doc",params:{id:w.replace(/\./gi,"\xB7")}}).href});return(w,M)=>T.dataLoaded?(q(),N("div",ot,[d("div",it,[d("form",rt,[d("fieldset",null,[d("label",ct,[J(d("input",{type:"checkbox",id:"show-text","onUpdate:modelValue":M[0]||(M[0]=b=>c.value=b)},null,512),[[ee,c.value]]),ht]),d("label",ut,[J(d("input",{type:"checkbox",id:"show-entities","onUpdate:modelValue":M[1]||(M[1]=b=>x.value=b)},null,512),[[ee,x.value]]),dt])])])]),d("div",ft,j(Number(T.docsTotal).toLocaleString())+" documents ",1),d("div",gt,[(q(!0),N(we,null,ke(T.docs,b=>(q(),N("div",{onMouseenter:D=>E(h)(b),onMouseleave:M[2]||(M[2]=D=>E(h)()),onClick:D=>E(A)(b._id),class:"card"},[d("h2",null,j(n.value(b._source,E(P).esTitleField)),1),c.value?(q(),N("div",vt,j(n.value(b._source,E(P).esTextField)),1)):be("",!0),x.value?(q(),N("div",yt,[(q(!0),N(we,null,ke(n.value(b._source,E(P).esEntitiesField),D=>(q(),N("div",{class:"entity-pill",onMouseenter:V=>E(m)(D),onMouseleave:V=>E(h)(b)},j(D),41,mt))),256))])):be("",!0),d("small",null,[d("em",null,j(n.value(b._source,E(P).esSourceField)),1),Y(" \xA0\xB7\xA0 "+j(n.value(b._source,E(P).esDateField))+" \xA0\xB7\xA0 "+j(b._id),1)])],40,pt))),256)),T.docs.length<T.docsTotal?(q(),N("div",xt,[d("button",{class:"pure-button",style:{"font-size":"85%"},onClick:M[3]||(M[3]=b=>w.$emit("loadBatch"))}," Load more... ")])):be("",!0)])])):(q(),N("div",lt,"Loading..."))}};const _t={style:{"flex-grow":"1",display:"flex",position:"relative"}},wt=je('<div style="flex-grow:1;" id="basemap-container"><canvas class="bgCanvas"></canvas><canvas class="hlCanvas"></canvas><canvas class="lbCanvas"></canvas><canvas class="lCanvas"></canvas><canvas class="hiddenCanvas"></canvas><canvas class="aCanvas"></canvas></div><div id="basemap-tooltip" class="card"></div>',2),Ct=[wt],St={props:{focusedEntities:Array,showLabels:Boolean,showClusterShapes:Boolean,showClusterLabels:Boolean,quickButUgly:Boolean,highlights:Boolean},emits:["query"],setup(T,{emit:k}){const c=T,x=C({});let n,h,m=1;function A(){var e=[];return m<16777215&&(e.push(m&255),e.push((m&65280)>>8),e.push((m&16711680)>>16),m+=1),"rgb("+e.join(",")+")"}Le(()=>{console.log("Loading basemap data...");let e={};Oe(P.basemap,a=>{a.Id=a.Id.toLowerCase();let f=a.Id;e[f]=a}).then(()=>{console.log("...basemap data loaded."),x.value=e,h={},n=Object.values(x.value).filter(a=>(a.x=+a.x,a.y=+a.y,a.size=+a.size,a.showlabel=a.showlabel=="true",a.hiddenCol=A(),h[a.hiddenCol]=a,!(isNaN(a.x)||isNaN(a.y)||isNaN(a.size)))),window.addEventListener("resize",w),w()})}),Ve(()=>{window.removeEventListener("resize",w)}),Q(()=>[c.focusedEntities,c.highlights],M),Q(()=>c.showLabels,M),Q(()=>c.showClusterLabels,D),Q(()=>c.showClusterShapes,D),Q(()=>c.quickButUgly,w),document.fonts.ready.then(w);function w(){n&&(D(),M())}function M(){const e=V(),a={h:c.highlights,e:c.focusedEntities,l:c.showLabels,u:c.quickButUgly,s:e},f=te(a),o=b.retrieve("highlight",f);if(o){$("#basemap-container canvas.hlCanvas").node().getContext("2d").putImageData(o.hl,0,0),$("#basemap-container canvas.lbCanvas").node().getContext("2d").putImageData(o.lb,0,0),$("#basemap-container canvas.lCanvas").node().getContext("2d").putImageData(o.l,0,0),$("#basemap-container canvas.hiddenCanvas").node().getContext("2d").putImageData(o.hidden,0,0);return}let s={},r=0,g=0,u=0;c.focusedEntities.forEach(t=>{let v=t.score;s[t.label.toLowerCase()]=v,r=Math.max(r,v),u+=v,g++});const z=.2,S=1e3,y=z*u/(r*g),l=y<.3?.3/y:1,G=Math.min(1,S/(l*u/r));n.forEach(t=>{t.highlight=!!s[t.Id],t.score=s[t.Id]||0,t.intensity=Math.max(0,Math.min(1,G*l*z*t.score/r))});const F=c.highlights,i=e.margin,R=e.width,p=e.height,L=e.x,U=e.y,O=e.sizeRatio,oe=16;let _=$("#basemap-container canvas.hlCanvas").attr("width",R+i.left+i.right).attr("height",p+i.top+i.bottom).node().getContext("2d"),W=$("#basemap-container canvas.lbCanvas").attr("width",R+i.left+i.right).attr("height",p+i.top+i.bottom).node().getContext("2d"),I=$("#basemap-container canvas.lCanvas").attr("width",(R+i.left+i.right)*window.devicePixelRatio).attr("height",(p+i.top+i.bottom)*window.devicePixelRatio).node().getContext("2d");I.setTransform(1,0,0,1,0,0),I.scale(window.devicePixelRatio,window.devicePixelRatio);let Z=$("#basemap-container canvas.hiddenCanvas").attr("width",R+i.left+i.right).attr("height",p+i.top+i.bottom).node().getContext("2d"),X;F?(c.quickButUgly?n.filter(t=>t.highlight).forEach(t=>{let v=O*t.size+1.2*oe;_.fillStyle="rgba(255,255,255,"+.5*t.intensity+")",_.fillRect(L(t.x)-v,U(t.y)-v,2*v,2*v)}):(n.filter(t=>t.highlight).forEach(t=>{_.fillStyle="rgba(255,255,255,"+t.intensity+")",_.beginPath(),_.arc(L(t.x),U(t.y),O*t.size+oe,0,2*Math.PI),_.fill()}),He(_.canvas,0,0,_.canvas.width,_.canvas.height,_.canvas.width/50),_.fillStyle="#FFFFFFBB",n.filter(t=>t.highlight).forEach(t=>{_.beginPath(),_.arc(L(t.x),U(t.y),O*t.size+.6,0,2*Math.PI),_.fill()})),X=n.filter(t=>t.highlight),I.strokeStyle="#999785",I.fillStyle="#FFFFFF"):(c.quickButUgly?(_.fillStyle="#6c655e",n.forEach(t=>{_.fillRect(L(t.x),U(t.y),2*(O*t.size+.5),2*(O*t.size+.5))})):(_.fillStyle="#6c655e",n.forEach(t=>{_.beginPath(),_.arc(L(t.x),U(t.y),O*t.size+.5,0,2*Math.PI),_.fill()})),X=n.filter(()=>!0),I.strokeStyle="#999785",I.fillStyle="#000000"),X.sort(function(t,v){return t.showlabel?v.showlabel?v.score-t.score||v.size-t.size:-1:v.showlabel?1:v.score-t.score||v.size-t.size}),X.forEach((t,v)=>{t.order=v});const fe=8;if(c.showLabels){const H=c.quickButUgly?150:1e4;I.font=12+'px "Nunito", sans-serif',I.textAlign="center",I.lineWidth=4,I.lineJoin="round",I.lineCap="round",W.fillStyle="#FFFFFF";const K=5;let se=100;X.filter((B,ne)=>ne<H).forEach((B,ne)=>{if(se<=0)return;const ce=B.label,ve=I.measureText(ce).width+2*6,ye=.8*12+2*6,me=L(B.x)-ve/2,xe=U(B.y)-ye/2+fe,Se=me+ve,Ee=xe+ye;let Me=!0;for(let he=me;he<Se;he+=K)for(let ue=xe;ue<Ee;ue+=K){var qe=W.getImageData(he,ue,1,1).data;qe[0]>0&&(he=Se,ue=Ee,Me=!1)}Me?(se--,W.rect(me,xe,ve,ye),W.fill(),I.strokeText(ce,L(B.x),U(B.y)+fe),I.fillText(ce,L(B.x),U(B.y)+fe),B.labelDisplayed=!0):B.labelDisplayed=!1})}if(c.highlights&&c.focusedEntities.length==0){I.textAlign="left";const t="No entity to display",v=20,H=p+i.top+i.bottom-20;I.fillText(t,v,H)}X.sort(function(t,v){return t.labelDisplayed?v.labelDisplayed?v.order-t.order:1:v.labelDisplayed?-1:v.order-t.order});const ie=10;X.forEach(t=>{Z.fillStyle=t.hiddenCol,Z.fillRect(L(t.x)-ie,U(t.y)-ie,2*ie,2*ie)}),$(".aCanvas").on("click",function(t){let v=t.layerX||t.offsetX,H=t.layerY||t.offsety;Math.round(e.x.invert(v)),Math.round(e.y.invert(H)),k("query",'"'+re.label.replace(/"/gi,"")+'"')});const ge=$("#basemap-tooltip"),pe=$("#basemap-container canvas.aCanvas");let re;$(".aCanvas").on("mousemove",function(t){const v=t.layerX||t.offsetX,H=t.layerY||t.offsety,K=Z.getImageData(v,H,1,1).data,se="rgb("+K[0]+","+K[1]+","+K[2]+")",B=h[se];if(B){re=B;let ne=B.label;ge.html(ne).style("left",ze(t)[0]+20+"px").style("top",ze(t)[1]+"px").style("opacity",1),pe.style("cursor","pointer")}else re=!1,ge.style("opacity",0),pe.style("cursor","default")}),$(".aCanvas").on("mouseleave",function(t){re=!1,ge.style("opacity",0),pe.style("cursor","default")});const Te={hl:_.getImageData(0,0,_.canvas.width,_.canvas.height),lb:W.getImageData(0,0,W.canvas.width,W.canvas.height),l:I.getImageData(0,0,I.canvas.width,I.canvas.height),hidden:Z.getImageData(0,0,Z.canvas.width,Z.canvas.height)};b.store("highlight",f,Te)}const b=function(){let e={};return e.stores={},e.maxStoreSize=25,e.store=function(a,f,o){e.stores[a]===void 0&&(e.stores[a]={});let s=e.stores[a];if(s[f]={ts:Date.now(),data:o},Object.keys(s).length>e.maxStoreSize){let g=1/0,u=!1;for(let z in s)s[z].ts<g&&(g=s[z].ts,u=z);delete s[u]}},e.retrieve=function(a,f){if(e.stores[a]){let o=e.stores[a];if(o[f]!==void 0)return o[f].ts=Date.now(),o[f].data}return!1},e}();function D(){window.polygon=[];const e=V(),a=e.margin,f=e.width,o=e.height,s=e.nodeMargin,r=e.x,g=e.y,u=e.sizeRatio;let z=$("#basemap-container canvas.bgCanvas").attr("width",f+a.left+a.right).attr("height",o+a.top+a.bottom),y=$("#basemap-container canvas.aCanvas").attr("width",(f+a.left+a.right)*window.devicePixelRatio).attr("height",(o+a.top+a.bottom)*window.devicePixelRatio).node().getContext("2d");y.setTransform(1,0,0,1,0,0),y.scale(window.devicePixelRatio,window.devicePixelRatio);let l=z.node().getContext("2d");if(c.quickButUgly)l.fillStyle="#9ba7a9",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.fillStyle="#999785",n.forEach(F=>{let i=u*F.size+s;l.fillRect(r(F.x)-i,g(F.y)-i,2*i,2*i)}),l.fillStyle="#504132",n.forEach(F=>{let i=u*F.size;l.fillRect(r(F.x)-i,g(F.y)-i,2*i,2*i)});else{l.fillStyle="#000000",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.fillStyle="rgba(255,255,255)",n.forEach(p=>{l.beginPath(),l.arc(r(p.x),g(p.y),u*p.size+P.heatmapSpread,0,2*Math.PI),l.fill()}),Ie(l.canvas,0,0,l.canvas.width,l.canvas.height,l.canvas.width/32);const F=ae(l.getImageData(0,0,l.canvas.width,l.canvas.height));l.fillStyle="#9ba7a9",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.fillStyle="#999785",n.forEach(p=>{l.beginPath(),l.arc(r(p.x),g(p.y),u*p.size+s,0,2*Math.PI),l.fill()}),l.fillStyle="#504132",n.forEach(p=>{l.beginPath(),l.arc(r(p.x),g(p.y),u*p.size,0,2*Math.PI),l.fill()});const i=p=>Math.pow(Math.max(0,.2+.8*Math.min(1,1.4*p||0)),.6);let R=l.getImageData(0,0,l.canvas.width,l.canvas.height);for(let p=0;p<R.data.length;p+=4){const L=F[p/4];R.data[p]=Math.floor(R.data[p]*(.85+.15*i(L))),R.data[p+1]=Math.floor(R.data[p+1]*(.85+.15*i(L))),R.data[p+2]=Math.floor(R.data[p+2]*(.85+.15*i(L)))}l.putImageData(R,0,0),Ie(l.canvas,0,0,l.canvas.width,l.canvas.height,l.canvas.width/128)}const G=function(F){y.beginPath(),F.forEach((i,R)=>{R==0?y.moveTo(r(i[0]),g(i[1])):y.lineTo(r(i[0]),g(i[1]))}),y.stroke()};if(c.showClusterShapes&&(y.lineWidth=.8,y.strokeStyle="#286667",P.basemapPolygons.forEach(G)),c.showClusterLabels){y.lineWidth=.8,y.strokeStyle="#286667",P.basemapLabelsLines.forEach(G);const F=6;y.font='16px "IBM Plex Serif", serif',y.lineWidth=4,y.lineJoin="round",y.lineCap="round",y.strokeStyle="#9ba7a9",y.fillStyle="#286667",P.basemapLabels.forEach(i=>{y.textAlign=i.anchor||"center",y.strokeText(i.label.toUpperCase(),r(i.x),g(i.y)+F),y.fillText(i.label.toUpperCase(),r(i.x),g(i.y)+F)})}}function V(){let e={};const a=document.getElementById("basemap-container").offsetWidth,f=document.getElementById("basemap-container").offsetHeight;e.margin={top:20,right:80,bottom:20,left:80},e.width=a-e.margin.left-e.margin.right,e.height=f-e.margin.top-e.margin.bottom,e.nodeMargin=8;var o=Pe(n,u=>u.x),s=Pe(n,u=>u.y);if(o[1]-o[0]>s[1]-s[0]){let u=.5*(s[0]+s[1]);s[0]=u-.5*(o[1]-o[0]),s[1]=u+.5*(o[1]-o[0])}else{let u=.5*(o[0]+o[1]);o[0]=u-.5*(s[1]-s[0]),o[1]=u+.5*(s[1]-s[0])}var r=[e.margin.left+3*e.nodeMargin,e.margin.left+e.width-3*e.nodeMargin],g=[e.margin.top+3*e.nodeMargin,e.margin.top+e.height-3*e.nodeMargin];if(r[1]-r[0]<g[1]-g[0]){let u=.5*(g[0]+g[1]);g[0]=u-.5*(r[1]-r[0]),g[1]=u+.5*(r[1]-r[0])}else{let u=.5*(r[0]+r[1]);r[0]=u-.5*(g[1]-g[0]),r[1]=u+.5*(g[1]-g[0])}return e.x=Fe().domain(o).range(r),e.y=Fe().domain(s).range([g[1],g[0]]),e.sizeRatio=P.basemapNodeSizeRatio*.3,e}function te(e){const a=JSON.stringify(e);return le(a)}function le(e){let a=0;for(let f=0;f<e.length;f++){let o=e.charCodeAt(f);a=(a<<5)-a+o,a=a&a}return a}function ae(e){let a={};a.elevation_strength=7e-4,a.hillshading_sun_azimuth=Math.PI*.8,a.hillshading_sun_elevation=Math.PI*.3;const f=e.width,o=e.height;let s=new Float64Array((f+1)*(o+1));const r=(z,S,y=.2)=>Math.atan(y*Math.sqrt(z**2+S**2)),g=(z,S)=>Math.atan2(-S,-z),u=function(z,S,y,l){return Math.cos(Math.PI-z-y)*Math.sin(S)*Math.sin(Math.PI*.5-l)+Math.cos(S)*Math.cos(Math.PI*.5-l)};for(let z=0;z<e.data.length;z+=4){e.data[z];const S=z/4,y=S%(f+1)==0?S:S-1,l=S%(f+1)==f+1-1?S:S+1,G=S<f+1?S:S-(f+1),F=S>(f+1)*(o+1-1)?S:S+(f+1),i=e.data[4*y],R=e.data[4*l],p=e.data[4*G],L=e.data[4*F],U=i-R,O=p-L,oe=r(U,O,a.elevation_strength*Math.sqrt(f*o)),Ce=g(U,O),_=u(Ce,oe,a.hillshading_sun_azimuth,a.hillshading_sun_elevation);s[S]=_}return s}return(e,a)=>(q(),N("div",_t,Ct))}};const Et={style:{display:"flex","flex-grow":"1",overflow:"hidden"}},Mt={style:{"flex-grow":"1",display:"flex","flex-direction":"column"}},kt={class:"headline"},zt={style:{height:"50px",display:"flex","flex-direction":"column","align-items":"stretch","justify-content":"center"}},It={style:{padding:"6px"}},Pt={class:"pure-form"},Ft={for:"show-labels",style:{padding:"6px"}},Rt=Y(" Show labels "),Dt={for:"show-cluster-shapes",style:{padding:"6px"}},Lt=Y(" Show cluster shapes "),Bt={for:"show-cluster-labels",style:{padding:"6px"}},$t=Y(" Show cluster labels "),Tt={for:"quick-but-ugly",style:{padding:"6px"}},qt=Y(" Ugly efficient "),Nt={style:{"background-color":"#000","flex-grow":"1",display:"flex"}},At={class:"documents-panel",style:{"min-width":"600px","max-width":"600px",display:"flex","flex-direction":"column","align-items":"stretch","justify-content":"center"}},Ut={setup(T){let k=C([]),c=C([]),x=C(0),n=C(!1),h=C(""),m=C(25),A=C(0),w=C(!1),M=C([]);const b=C(!0),D=C(!0),V=C(!0),te=C(!1),le=function(o,s){const r="elastic",g="9pSJ5siACNtVAUwB2mj8";return fetch("http://10.92.0.111:9200/"+o,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Basic "+We.encode(r+":"+g)},body:JSON.stringify(s)}).then(u=>{if(u.ok)return u.json();console.warn("/!\\ Server returned "+u.status+" : "+u.statusText)})},ae=function(){return h.value==""?{match_all:{}}:{query_string:{query:h.value,default_field:P.esTextField}}},e=function(){console.log("Query:",ae()),A.value=2*m.value;let o={track_total_hits:!0,from:0,size:A.value,query:ae(),aggs:{"entities-agg":{terms:{size:1e4,field:P.esEntitiesField}}}};h.value==""&&(o.sort={},o.sort[P.esDateField]={order:"desc"}),le(P.esIndex+"/_search/",o).then(s=>{console.log("Response:",s),k.value=s.hits.hits,s.aggregations&&s.aggregations["entities-agg"]&&s.aggregations["entities-agg"].buckets&&(c.value=s.aggregations["entities-agg"].buckets),n.value=!0,x.value=s.hits.total.value,f.value({highlight:!1,entities:[]})}).catch(s=>{console.warn(s)})};let a=C(function(){le(P.esIndex+"/_search/",{from:A.value,size:m.value,query:ae()}).then(o=>{o.hits.hits.forEach(s=>{k.value.push(s)}),A.value+=m.value}).catch(o=>{console.warn(o)})}),f=C(function(o){o.highlight?(M.value=o.entities.map(s=>({label:s,score:1})),w.value=!0):h.value==""?(M.value=[],w.value=!1):(M.value=c.value.map(s=>({label:s.key,score:s.doc_count})),w.value=!0)});return Le(()=>{e()}),Q(h,o=>{e()}),(o,s)=>(q(),N("main",Et,[d("div",Mt,[d("div",kt,[d("h1",null,"ADD | "+j(E(P).title),1)]),d("div",zt,[de(nt,{onQuery:s[0]||(s[0]=r=>Re(h)?h.value=r:h=r),query:E(h)},null,8,["query"])]),d("div",It,[d("form",Pt,[d("fieldset",null,[d("label",Ft,[J(d("input",{type:"checkbox",id:"show-labels","onUpdate:modelValue":s[1]||(s[1]=r=>b.value=r)},null,512),[[ee,b.value]]),Rt]),d("label",Dt,[J(d("input",{type:"checkbox",id:"show-cluster-shapes","onUpdate:modelValue":s[2]||(s[2]=r=>D.value=r)},null,512),[[ee,D.value]]),Lt]),d("label",Bt,[J(d("input",{type:"checkbox",id:"show-cluster-labels","onUpdate:modelValue":s[3]||(s[3]=r=>V.value=r)},null,512),[[ee,V.value]]),$t]),d("label",Tt,[J(d("input",{type:"checkbox",id:"quick-but-ugly","onUpdate:modelValue":s[4]||(s[4]=r=>te.value=r)},null,512),[[ee,te.value]]),qt])])])]),d("div",Nt,[de(St,{"focused-entities":E(M),highlights:E(w),"show-labels":b.value,"show-cluster-shapes":D.value,"show-cluster-labels":V.value,"quick-but-ugly":te.value,onQuery:s[5]||(s[5]=r=>Re(h)?h.value=r:h=r)},null,8,["focused-entities","highlights","show-labels","show-cluster-shapes","show-cluster-labels","quick-but-ugly"])])]),d("div",At,[de(bt,{docs:E(k),"data-loaded":E(n),"docs-total":E(x),onLoadBatch:E(a),onFocusedEntities:E(f)},null,8,["docs","data-loaded","docs-total","onLoadBatch","onFocusedEntities"])])]))}},Be=Xe({history:Ke("/infomedia/"),routes:[{path:"/",name:"home",component:Ut},{path:"/doc/:id",name:"doc",component:()=>_e(()=>import("./DocView.871230cc.js"),["assets/DocView.871230cc.js","assets/DocView.c415fa95.css","assets/vendor.bfe29a18.js"])},{path:"/help-infomedia",name:"help-infomedia",component:()=>_e(()=>import("./HelpInfomedia.a471bb36.js"),["assets/HelpInfomedia.a471bb36.js","assets/HelpInfomedia.15c8e258.css","assets/plugin-vue_export-helper.21dcd24c.js","assets/vendor.bfe29a18.js"])},{path:"/help-scopus",name:"help-scopus",component:()=>_e(()=>import("./HelpScopus.b34ad812.js"),["assets/HelpScopus.b34ad812.js","assets/HelpInfomedia.15c8e258.css","assets/plugin-vue_export-helper.21dcd24c.js","assets/vendor.bfe29a18.js"])}]}),$e=Qe(Ge);$e.use(Be);$e.mount("#app");export{St as _,P as i};
